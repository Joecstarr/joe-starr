<script src="https://cdn.jsdelivr.net/npm/@svgdotjs/svg.js@3.0/dist/svg.min.js"></script>
<script src="/tools/draw_wptt/draw_wptt.js" type="text/javascript"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mdbassit/Coloris@latest/dist/coloris.min.css" />
<script src="https://cdn.jsdelivr.net/gh/mdbassit/Coloris@latest/dist/coloris.min.js"></script>
<style>
    .example {
        flex-shrink: 0;
        margin-bottom: 30px;
    }

    .convert,
    .download {
        width: 100%;
    }

    #svg-container svg {
        width: 100% !important;
        height: auto !important;
    }
</style>


<div class="w-full">
    <label>
        Tangle:
        <input id="notation" class="w-full bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral" type="text" value="i(4[5 8 3]4(4(4[2 25 ]-40[3 2 3]1)4[7 2 9]1)1)">
    </label>
</div>
<section class="flex flex-wrap m-8">
        <div class="m-8 grow">
            <p>Strand Color:</p>
            <div class="" style="color: MediumSlateBlue; " data-darkreader-inline-color=""><button
                    type="button" aria-labelledby="clr-open-label"></button><input class="bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral" type="text" value="MediumSlateBlue"
                    id="fcolordata" data-coloris=""></div>
        </div>
        <div class="m-8 grow">
            <p>Crossing Color:</p>
            <div class=" " style="color: #ff5555; " data-darkreader-inline-color=""><button type="button"
                    aria-labelledby="clr-open-label"></button><input class="bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral" type="text" id="bcolordata" value="#ff5555"
                    data-coloris=""></div>
        </div>
        <div class="m-8 grow">
            <p>
                Eccentricity:
            </p>
            <div class=" ">
                <input class="bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral"  type="number" id="eccentricitydata" min="1" value="40">
            </div>
        </div>
        <div class="m-8 grow">
            <p>
                String Size:</p>
            <div class="field ">
                <input class="bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral"  type="number" id="scaledata" min="1" value="1">
            </div>
        </div>
        <div class="m-8 grow">
            <p>
                Gap Size:</p>
            <div class=" ">
                <input class="bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral"  type="number" id="gapdata" min="1" value="10">
            </div>
        </div>
</section>
<br/>
<br/>
<section class="">
    <button
    class="m-8 !rounded-md bg-primary-600 px-4 py-2 !text-neutral !no-underline hover:!bg-primary-500 dark:bg-primary-800 dark:hover:!bg-primary-700 convert">Draw</button>
    <br/>
    <br/>
    <div id="svg-container" class="m-8"></div>
    <br/>
    <br/>
    <button
    class="m-8 !rounded-md bg-primary-600 px-4 py-2 !text-neutral !no-underline hover:!bg-primary-500 dark:bg-primary-800 dark:hover:!bg-primary-700 download">Download</button>
</section>


<script type="text/javascript">
    document.querySelector('.convert').addEventListener('click', () => {
        var svg = document.getElementById('svg-container');
        var fcolor = document.getElementById('fcolordata').value;
        var bcolor = document.getElementById('bcolordata').value;
        var eccentricity = document.getElementById('eccentricitydata').value / 100;
        var scale = document.getElementById('scaledata').value;
        var gap = document.getElementById('gapdata').value;
        var note = document.getElementById('notation').value;
        svg.innerHTML = "";
        var drawing = new Drawing(note, '#svg-container', fcolor, bcolor, eccentricity, scale, gap)
        drawing.draw()
    });

    document.querySelector('.download').addEventListener('click', () => {
        function uuidv4() {
            return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, c =>
                (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)
            );
        }
        const svg = document.querySelector('#svg-container').innerHTML;
        const blob = new Blob([svg.toString()]);
        const element = document.createElement("a");
        element.download = uuidv4() + ".svg";
        element.href = window.URL.createObjectURL(blob);
        element.click();
        element.remove();
    });
</script>